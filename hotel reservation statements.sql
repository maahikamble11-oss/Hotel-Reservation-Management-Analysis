create database hotel_db;
use hotel_db;

CREATE TABLE rooms (
    room_id INT PRIMARY KEY,
    room_number VARCHAR(10),
    room_type VARCHAR(20),
    capacity INT,
    price_per_night DECIMAL(10,2),
    status VARCHAR(20)
);

INSERT INTO rooms VALUES
(1, '101', 'Standard', 2, 2200, 'Available'),
(2, '102', 'Standard', 2, 2200, 'Booked'),
(3, '103', 'Standard', 2, 2200, 'Available'),
(4, '201', 'Deluxe', 3, 3500, 'Available'),
(5, '202', 'Deluxe', 3, 3500, 'Booked'),
(6, '203', 'Deluxe', 3, 3500, 'Available'),
(7, '301', 'Suite', 4, 6000, 'Available'),
(8, '302', 'Suite', 4, 6000, 'Maintenance'),
(9, '303', 'Suite', 4, 6000, 'Booked');

CREATE TABLE guests (
    guest_id INT PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    phone VARCHAR(15),
    email VARCHAR(100)
);

INSERT INTO guests VALUES
(1, 'Amit', 'Sharma', '9876543201', 'amit.sharma@example.com'),
(2, 'Neha', 'Verma', '9988776655', 'neha.verma@example.com'),
(3, 'John', 'Mathew', '9123456780', 'john.mathew@example.com'),
(4, 'Sara', 'Khan', '9784512360', 'sara.khan@example.com'),
(5, 'Rohit', 'Patil', '9087654321', 'rohit.patil@example.com'),
(6, 'Meera', 'Joshi', '9198765432', 'meera.joshi@example.com'),
(7, 'David', 'Wilson', '9877001122', 'david.wilson@example.com');

CREATE TABLE reservations (
    reservation_id INT PRIMARY KEY,
    guest_id INT,
    room_id INT,
    check_in_date DATE,
    check_out_date DATE,
    total_amount DECIMAL(10,2),
    status VARCHAR(20),
    FOREIGN KEY (guest_id) REFERENCES guests(guest_id),
    FOREIGN KEY (room_id) REFERENCES rooms(room_id)
);

INSERT INTO reservations VALUES
(1, 1, 2, '2025-01-05', '2025-01-08', 6600, 'Completed'),
(2, 2, 5, '2025-01-10', '2025-01-12', 7000, 'Completed'),
(3, 3, 1, '2025-01-15', '2025-01-16', 2200, 'Cancelled'),
(4, 4, 7, '2025-01-20', '2025-01-25', 30000, 'Active'),
(5, 5, 4, '2025-01-22', '2025-01-24', 7000, 'Upcoming'),
(6, 6, 3, '2025-01-25', '2025-01-27', 4400, 'Active'),
(7, 7, 9, '2025-01-28', '2025-01-30', 12000, 'Completed');

CREATE TABLE payments (
    payment_id INT PRIMARY KEY,
    reservation_id INT,
    amount DECIMAL(10,2),
    payment_method VARCHAR(20),
    payment_date DATE,
    FOREIGN KEY (reservation_id) REFERENCES reservations(reservation_id)
);

INSERT INTO payments VALUES
(1, 1, 6600, 'UPI', '2025-01-05'),
(2, 2, 7000, 'Credit Card', '2025-01-10'),
(3, 3, 2200, 'Cash', '2025-01-15'),
(4, 4, 15000, 'Debit Card', '2025-01-20'),
(5, 4, 15000, 'UPI', '2025-01-22'),
(6, 5, 7000, 'Credit Card', '2025-01-22'),
(7, 7, 12000, 'UPI', '2025-01-28');

CREATE TABLE staff (
    staff_id INT PRIMARY KEY,
    staff_name VARCHAR(100),
    role VARCHAR(50),
    phone VARCHAR(15)
);

INSERT INTO staff VALUES
(1, 'Ramesh Joshi', 'Receptionist', '9012345678'),
(2, 'Priya Desai', 'Manager', '9876501234'),
(3, 'Sameer Khan', 'Receptionist', '9801234567'),
(4, 'Meena Gupta', 'Housekeeping', '9890123456'),
(5, 'Anil More', 'Security', '9900112233');

CREATE TABLE checkins (
    checkin_id INT PRIMARY KEY,
    reservation_id INT,
    staff_id INT,
    checkin_time DATETIME,
    FOREIGN KEY (reservation_id) REFERENCES reservations(reservation_id),
    FOREIGN KEY (staff_id) REFERENCES staff(staff_id)
);

INSERT INTO checkins VALUES
(1, 1, 1, '2025-01-05 11:00:00'),
(2, 2, 3, '2025-01-10 13:00:00'),
(3, 4, 1, '2025-01-20 12:30:00'),
(4, 5, 2, '2025-01-22 14:00:00'),
(5, 6, 3, '2025-01-25 15:00:00'),
(6, 7, 1, '2025-01-28 10:00:00');

-- 1. Total Rooms in the Hotel

-- Problem Statement:
-- Management wants to know the total number of rooms registered in the system.

SELECT 
    COUNT(*) AS total_rooms
FROM
    rooms;

-- 2. Available vs Booked Rooms

-- Problem Statement:
-- Show how many rooms are available and how many are booked.

SELECT 
    status, COUNT(*) AS total
FROM
    rooms
GROUP BY status;

-- 3. Total Number of Guests

-- Problem Statement:
-- Find total guests who have made at least one booking.

SELECT 
    COUNT(DISTINCT guest_id) AS total_guests
FROM
    reservations;
    
-- 4. Bookings per Room Type

-- Problem Statement:
-- Show how many bookings exist for each room type.

SELECT 
    r.room_type, COUNT(*) AS total_bookings
FROM
    rooms r
        JOIN
    reservations res ON r.room_id = res.room_id
GROUP BY r.room_type;  

-- 5. Revenue per Room Type

-- Problem Statement:
-- Calculate revenue generated by each room type.

SELECT 
    r.room_type, SUM(res.total_amount) AS total_revenue
FROM
    rooms r
        JOIN
    reservations res ON r.room_id = res.room_id
GROUP BY r.room_type;

-- 6. Current Active Reservations

-- Problem Statement:
-- show reservations active today.

SELECT 
    *
FROM
    reservations
WHERE
    CURDATE() BETWEEN check_in_date AND check_out_date;
    
-- 7. Frequent Guests

--  Statement:
-- Show guests who booked more than 3 stays.

SELECT 
    guest_id, COUNT(*) AS total_bookings
FROM
    reservations
GROUP BY guest_id
HAVING COUNT(*) > 3;

-- 8. Upcoming Check-ins (Next 24 Hours)

-- Problem Statement:
-- List guests scheduled to check in tomorrow.

SELECT 
    *
FROM
    reservations
WHERE
    check_in_date = DATE_ADD(CURDATE(), INTERVAL 1 DAY);
    
-- 9. Todayâ€™s Check-outs

-- Problem Statement:
-- Show all guests checking out today.

SELECT 
    *
FROM
    reservations
WHERE
    check_out_date = CURDATE();
    
-- 10. Monthly Revenue Summary

-- Problem Statement:
-- Total revenue for a specific month.

SELECT 
    MONTH(check_in_date) AS month,
    SUM(total_amount) AS monthly_revenue
FROM
    reservations
GROUP BY MONTH(check_in_date);

-- 11. Staff Member Handling Most Check-ins

-- Problem Statement:
-- Find which staff member handled the maximum check-ins.

SELECT 
    staff_id, COUNT(*) AS total_checkins
FROM
    checkins
GROUP BY staff_id
ORDER BY total_checkins DESC
LIMIT 1;

-- 12. Hotel Occupancy Rate

-- Problem Statement:
-- Calculate occupancy rate: rooms booked / total rooms * 100.

SELECT 
    (SELECT 
            COUNT(*)
        FROM
            reservations
        WHERE
            CURDATE() BETWEEN check_in_date AND check_out_date) * 100.0 / (SELECT 
            COUNT(*)
        FROM
            rooms) AS occupancy_rate;
            
-- 13. Canceled Reservations Report

-- Problem Statement:
-- Show all canceled reservations.

SELECT 
    reservation_id, guest_id, room_id
FROM
    reservations
WHERE
    status = 'Cancelled';
    
-- 14. Average Length of Stay

-- Problem Statement:
-- Compute average number of days guests stay.

SELECT 
    AVG(DATEDIFF(check_out_date, check_in_date)) AS average_stay_days
FROM
    reservations;
    
-- 15. Most Used Payment Method

-- Problem Statement:
-- Show payment methods with count.

SELECT 
    payment_method, COUNT(*) AS usage_count
FROM
    payments
GROUP BY payment_method
ORDER BY usage_count DESC;




    
    
    
    




